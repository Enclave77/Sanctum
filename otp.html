<!DOCTYPE html><meta charset="utf-8"><pre id="out">診断中…</pre>
<script type="module">
import { createClient } from "https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm";
const sb=createClient("https://tfdudoaizixkiiujdrnj.supabase.co","＜anonをフルで＞");
const q=new URLSearchParams(location.search);
const h=new URLSearchParams(location.hash.startsWith('#')?location.hash.slice(1):location.hash);
const pick=k=>q.get(k)||h.get(k);
const P={code:pick('code'), token_hash:pick('token_hash'), type:pick('type')||'magiclink'};
out.textContent=JSON.stringify({href:location.href,hash:location.hash,search:location.search,params:P},null,2);
let err;
if(P.token_hash){({error:err}=await sb.auth.verifyOtp({type:P.type,token_hash:P.token_hash}))}
else if(P.code){({error:err}=await sb.auth.exchangeCodeForSession(location.href))}
else{err={message:"URLに認証パラメータなし"}}
out.textContent+= err?`\n\nERROR: ${err.message}`:`\n\nOK: ログイン成功`; 
</script>

